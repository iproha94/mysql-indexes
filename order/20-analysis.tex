\chapter{Аналитический раздел}

В данном разделе проводится обзор современных СУБД и анализ их инструментов для управления индексами.

\section{Современные СУБД}

Рассмотрим самые популярные СУБД. \ref{table:list_dbms}

\begin{table}[h]
\caption{Рейтинг СУБД}\label{table:list_dbms}.
\medskip
\begin{tabular}{|l|l|l|p{9cm}|}
\hline
название & год & sql & разработчик\\
\hline
MySQL & 1995 & да & Oracle\\
PostgreSQL & 1995 & да & сообщество\\
MS SQL Server & 1988 & да & Microsoft\\
MongoDB & 2009 & нет & MongoDB\\
SQLite & 2000 & да & Hwaci, сообщество\\
Oracle Database & 1979 & да & Oracle\\
Firebird & 2000 & да & сообщество\\
CouchDB & 2005 & нет & Apache\\
DB2 & 1995 & да & IBM\\
MariaDB & 2009 & да & MariaDB Corporation Ab, MariaDB Foundation, сообщество\\
RavenDB & 2009 & нет & Hibernating Rhinos\\
Redis & 2009 & нет & Redis Labs, сообщество\\
SAP ASE (ex: Sybase) & 1988 & да & SAP AG\\
Percona Server & 2006 & да & Percona\\
\hline
\end{tabular}
\end{table}

Рейтинг СУБД выпускается Тэглайном впервые и сформирован на основе анкетирования (проводилось с августа 2014 по апрель 2016 года) 390 digital-агентств с продакшном и/или клиентским офисом в России: респондентам предлагалось выбрать один или несколько вариантов ответа на вопрос «Укажите СУБД, которые вы используете при разработке проектов». \cite{tagline.ru:List_DBMS}

Большинство реляционных СУБД, за исключением MS Access, состоят из двух отдельных компонентов: «back-end», где хранятся данные и «front-end» — пользовательский интерфейс для взаимодействия с данными. Этот тип конструкции достаточно умный, так как он распараллеливает двухуровневую модель программирования, которая отделяет слой данных от пользовательского интерфейса и позволяет сконцентрировать рынок ПО непосредственно на улучшении своих продуктов. Эта модель открывает двери для третьих сторон, которые создают свои приложения для взаимодействия с различными базами данных. \cite{habrahabr.ru:10_best_tools} 

Данный подход позволяет сторонним разработчикам создавать инструменты для администрирования СУБД. Рассмотрим некоторые СУБД и предлагаемые инструменты для их администрирования, а в частности, индексирования более подробно.

\input{21-oracle}

\input{21-ms-server}

\input{21-postgresql}

\input{21-mysql}

\section{Результаты анализа возможностей СУБД и их инструментов для индексирования}

Результаты проведенного анализа представлены в таблице  \ref{table:dbms_and_tools_for_indexes}

\begin{table}[h]
\caption{Возможности СУБД их инструментов для индексирования}\label{table:dbms_and_tools_for_indexes}.
\medskip
\begin{tabular}{|p{4cm}|p{2cm}|p{2cm}|p{2cm}|p{2cm}|}
\hline
Возможность & Oracle & MS SQL Server и Azure SQL Database & PostgreSQL & MySQL\\
\hline
автоматический процесс создания индексов & да & да & нет & нет\\
\hline
автоматический процесс удаления индексов & да & да & нет & нет\\
\hline
отчет о рекомендуемых для создания индексов & да & да & да & нет\\
\hline
отчет о рекомендуемых для удаления индексов & да & да & да & да\\
\hline
отчет о найденых дубликатах индексов & да & да & да & да\\
\hline
анализ использования индексов & да & да & да & да\\
\hline
\end{tabular}
\end{table}

\section{Выводы}

Из результатов проведенного анализа видно, что в одной из самых популярных СУБД MySQL отсутствует возможность получения отчетов о рекомендациях по созданию индексов, что становится причиной отсутствия в данной СУБД инструмента по автоматизированному управлению индексами (создание, применение, удаление).

На основе выполненного анализа обоснована необходимость разработки нового \nom{ПО}{Програмное обеспечение} для рекомендации создания индексов для СУБД MySQL, что подтверждается многочисленными вопросами о поиске данного инструмента и ответами о его отсутствии. \cite{stackoverflow.com:as_mssql_tuning_advisor,stackoverflow.com:automatic-index-creation,stackoverflow.com:help-me-optimise-my-queries-and-index-settings,stackoverflow.com:auto-build-indexes,experts-exchange.com:as_engine_tuning_advisor} 

Для процесса разработки такого инструмента необходимо учитывать, что:
\begin{enumerate}
\item инструмент создается для использования АБД;
\item инструмент может быть использован для дальнейшей автоматизации процесса управления индексами.
\end{enumerate}

В качестве аналогичного инструмента рассмотрим \textit{Index Advisor} для СУБД \textit{PostgreSQL}. Процесс работы инструмента представлен на рисунке \ref{img:index_advisor_postgresql}

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.7]{index-advisor-postgresql.png}
  \caption{Процесс работы Index Advisor для PostgreSQL}
  \label{img:index_advisor_postgresql}
\end{figure}

\paragraph{Требования к разрабатываемому инструменту}
\begin{enumerate}
\item Считывание текстового файла с набором SQL запросов. Каждый запрос записывается в одной строчку. Несколько запросов разделяется символом ";" и переводом строки;
\item В зависимости от считанного файла в случае успеха разбора всех запросов программа должна возвращать 0, а в случае ошибки хотя бы в одном запросе - ненулевое значение, которое, как правило, интерпретируется как код ошибки. Если встречается ошибка, то прекратить дальнейший разбор файла;
\item Для успешно считанных индексов создать файл-скрипт с инструкциями CREATE INDEX для создания индексов для этих запросов.
\end{enumerate}

\paragraph{Тестирование разрабатываемого инструмента} 

Правильность работы инструмента необходимо проверить на эксперементальной БД с помощью:
\begin{enumerate}
\item команды \textit{EXPLAIN}, доказывающим, что СУБД использует построенный индекс при выполнении данного запроса;
\item команды \textit{SHOW PROFILER}, доказывающим уменьшение времени выполнения запросов после добавления индекса.
\end{enumerate}
